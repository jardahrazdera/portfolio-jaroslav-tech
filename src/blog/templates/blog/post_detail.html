{% extends 'core/base.html' %}
{% load static %}
{% load image_tags %}

{% block title %}{{ post.title }} - {{ block.super }}{% endblock %}

{% block meta_description %}{% if post.excerpt %}{{ post.excerpt|striptags }}{% else %}{{ post.content|striptags|truncatewords:50 }}{% endif %}{% endblock %}

{% block extra_head %}
{% if debug %}
<link rel="stylesheet" href="{% static 'blog/css/blog.css' %}">
{% else %}
<link rel="stylesheet" href="{% static 'dist/blog.min.css' %}">
{% endif %}
{% endblock %}

{% block structured_data %}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "{{ post.title }}",
  "author": {
    "@type": "Person",
    "name": "{{ post.author.get_full_name|default:post.author.username }}"
  },
  "publisher": {
    "@type": "Person",
    "name": "Jaroslav Hrazdera"
  },
  "datePublished": "{{ post.created_at|date:'c' }}",
  "dateModified": "{{ post.updated_at|date:'c' }}",
  "description": "{% if post.excerpt %}{{ post.excerpt|striptags }}{% else %}{{ post.content|striptags|truncatewords:50 }}{% endif %}",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "{{ request.build_absolute_uri }}"
  }
}
</script>
{% endblock %}

{% block before_main %}
{% include 'blog/components/breadcrumb.html' with post=post %}
{% endblock %}

{% block content %}
<section class="content-section">
    <div class="container">
        <article class="post-detail">
            <header class="post-header">
                <h2>{{ post.title }}</h2>

                {% include 'blog/components/enhanced_post_meta.html' with post=post show_updated=True compact=False show_reading_time=True show_author=True show_stats=True %}

                {% include 'blog/components/post_taxonomy.html' with post=post layout='horizontal' show_labels=True compact=False %}
            </header>

            {% if post.featured_image %}
                <div class="post-featured-image">
                    {% responsive_image post size='large' css_class='featured-image' alt_text=post.title %}
                </div>
            {% endif %}

            {% if post.excerpt %}
                <div class="post-excerpt-detail">
                    <em>{{ post.excerpt }}</em>
                </div>
            {% endif %}

            <div class="blog-content">
                {{ post.content|safe }}
            </div>
        </article>

        <nav class="blog-navigation">
            <div class="hero-buttons">
                <a href="{% url 'blog:post_list' %}" class="btn btn-primary">&larr; Back to Blog</a>
            </div>
        </nav>
    </div>
</section>
{% endblock %}